<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset = 'utf-8'>
    <title>charizard battle</title>
    <link rel = 'shortcut icon' type = 'image/gif' href = 'sprites/mega%20charizard%20x.gif'></link>
    <style>
    @keyframes pikaLand{
      from{left:400px;}
      to{left:-25px;}
    }
    @keyframes pika{
      from{left:435px;}
      to{left:10px;}
    }
    @keyframes charizardLand{
      from{left:450px;}
      to{left:900px;}
    }
    @keyframes charizard{
      from{left:500px;}
      to{left:950px;}
    }
    @keyframes ram{
      from{left:10px;
      top:400px;}
      to{left:950px;
      top:50px;}
    }
    @keyframes jump{
      0%{top:400px}
      50%{top:10px}
      100%{top:400px}
    }
    body{
      background-image: url('sprites/background.png');
    }
    #moves{
      z-index: 6;
    }
    #myHealthBar{
      position:absolute;
      left:70px;
      top:340px;
      border: 5px ridge;
      background-color: yellow;
      z-index:5;
      align-items: center;
    }
    #opponentHealthBar{
      position:absolute;
      left:1000px;
      top:300px;
      border: 5px ridge;
      background-color: red;
      z-index:5;
      align-items: center;
    }
    .container{
      width:50px;
      background-color: black;
      color: black;
      border-radius: 5px;
      height:10px;
    }
    .bar{
      width:50px;
      color: lightgreen;
      background-color: lightgreen;
      border-radius: 5px;
      height:10px;
    }
    #return{
      position: absolute;
      top: 425px;
      left:500px;
    }
    #opponentMove{
      position:absolute;
      left:20px;
      top:300px;
      z-index: 1;
    }
    #myMove{
      position:absolute;
      left:925px;
      top:100px;
      z-index: 3;
    }
    #charizard{
      position: absolute;
      left:950px;
      top:0px;
      z-index: 2;
      animation-name: charizard;
      animation-duration: 3s;
    }
    #mega{
      position: absolute;
      left:950px;
      top:100px;
      z-index: 2;
    }
    #pikachu{
      position: absolute;
      left:10px;
      top:400px;
      z-index: 2;
      animation-name: pika;
      animation-duration: 3s;
    }
    #PikaLandSvg{
      z-index:1;
      position: absolute;
      left:-25px;
      top:450px;
      animation-name: pikaLand;
      animation-duration: 3s;
    }
    #CharizardLandSvg{
      z-index:1;
      position: absolute;
      left:900px;
      top:150px;
      animation-name: charizardLand;
      animation-duration: 3s;
    }
    #electro-ball{
      position: absolute;
      left:200px;
      top:350px;
    }
    #volt-tackle{
      position: absolute;
      left:200px;
      top:400px;
    }
    #thunder-bolt{
      position: absolute;
      left:300px;
      top:400px;
    }
    #Gigavolt-havoc{
      position: absolute;
      left:300px;
      top:350px;
    }
    .flame{
      transform: rotate(250deg);
      position:absolute;
      top:250px;
      left:150px;
    }
    #typewriter{
      color: white;
      font-family: monospace;
      background-color: red;
      border: 10px solid grey;
      width:100%;
      height:50px;
      position:absolute;
      top:520px;
    }
    button {
      padding:10px;
      display: inline-block;
      cursor: pointer;
      text-align: center;
      text-decoration: none;
      outline: none;
      color: #fff;
      background-color: #4CAF50;
      border: none;
      border-radius: 15px;
      box-shadow: 0 5px #999;
      transition-duration: 0.4s;
    }

    button:hover {
      background-color: #f44336;
    }

    button:active {
      background-color: #3e8e41;
      box-shadow: 0 2px #666;
      transform: translateY(4px);
    }
    </style>
  </head>
  <body onload = "startTheGame()">
    <div id ='myHealthBar'><div>pikachu<br><div id = 'myHealthText'>300/300</div><div class = 'container'><div id = 'myHealthGraphic' class = 'bar'>  </div></div></div></div>
    <div id ='opponentHealthBar'><div>charizard<br><div id = 'opponentHealthText'>400/400</div><div class = 'container'><div id = 'opponentHealthGraphic' class = 'bar'>  </div></div></div></div>
    <img id = 'charizard' src = 'sprites/Charizard.gif' width = '200' alt = 'charizard'>
    <img id= 'mega' src = 'sprites/mega%20stone.png' width = '25'>
    <svg id="PikaLandSvg" width="264px" height="77px">
        <ellipse cx="135" cy="50" rx="100" ry="25"
                 style="stroke:#c18605;
                           stroke-width:6px;
                           fill:#ffbf0f;"></ellipse>
    </svg>
    <svg id="CharizardLandSvg" width="264px" height="77px">
        <ellipse cx="135" cy="50" rx="100" ry="25"
                 style="stroke:#c18605;
                           stroke-width:6px;
                           fill:#ffbf0f;"></ellipse>
    </svg>
    <img id = 'pikachu' src = 'sprites/pikachu.gif' width = '200' alt = 'pikachu'>
    <img id = 'opponentMove' src = '' width = '200' alt = "opponent's move">
    <img class = 'flame' src = 'sprites/flamethrower.gif'>
    <img id = 'myMove' src = '' width = '200' alt = 'my move'>
    <div id = 'menu'>
    <div id = 'moves'>
      <button id = 'electro-ball' onclick = 'electroBall()'>electro ball</button>
      <button id = 'volt-tackle' onclick="voltTackle()">volt tackle</button>
      <button id = 'thunder-bolt' onclick="thunderbolt()">thunderbolt</button>
      <button id = 'Gigavolt-havoc' onclick="tackle()">tackle</button>
    </div>
  </div>
    <!--<a id = 'return' href='forest11.htm'>go back to main route</a>-->
    <div id = 'typewriter'></div>
    <script src = 'file:///Users/xjin/djin/code/js/jquery.js'></script>
    <script>
    $(".flame").hide();
    $("#menu").hide()
    $("#mega").hide()
    var opponentHealth = 400;
    var myHealth = 300;
    var megaEvolve;
    var isMegaEvolved = false;
    var isTyping = false;
    var meAttacking = false;
    var opponentAttacking = false;
    var gameOver = function(lost){
        $("img").hide();
        $("#menu").hide();
        $("#myHealthBar").hide();
        $("#opponentHealthBar").hide();
        $("svg").hide();
      if(lost){
        type('you lost')
        $("#return").show();
      }
      else{
        type('you won!')
        $("#return").show();
      }
};
    var type = function(typo){
      isTyping = true;
      opponentAttacking = false;
      meAttacking = false;
      $("#typewriter").text('')
      $("button").hide()
      for(let i = 0;i <= typo.length;i++){
        setTimeout(function(){
          $("#typewriter").append(typo[i])
          if(i === typo.length){
            isTyping = false;
            $("button").show();
          }
        },100 * i)
      }
    }
    var decreaseMyHp = function(Hp){
      for(let i = 0;i < Hp;i++){
        setTimeout(function(){
          myHealth--;
          $('#myHealthText').text(myHealth + '/300');
          $("#myHealthGraphic").css("width",myHealth/6 + "px");
        },100 * i)
      }
    }
    var decreaseOpponentHp = function(Hp){
      for(let i = 0;i < Hp;i++){
        setTimeout(function(){
          opponentHealth--;
          $('#opponentHealthText').text(opponentHealth + '/400');
          $("#opponentHealthGraphic").css("width",opponentHealth/8 + "px");
        },100 * i)
      }
    }
      startTheGame = function(){
      $('#return').hide();
      $('#pikachu').hide();
      $('#pikachu').fadeIn(1000);
      $('#charizard').hide();
      $('#charizard').fadeIn(1000);
      setTimeout(function(){
        type('get ready for battle!')
        $("#menu").show();
      },3000)
    };
      thunderbolt = function(){
        opponentAttacking = false;
        $("#opponentMove").hide();
        $("#flame").hide();
        $('#myMove').show();
        $('#myMove').attr('src','sprites/lightning.png');
        //$("#menu").hide();
        type('you used thunderbolt')
        meAttacking = true;
        decreaseOpponentHp(10);
        $('#myMove').hide();
        $("#menu").hide();
        if(myHealth<=0){
          gameOver(true)
        }
        if(opponentHealth<=0){
          gameOver(false)
        }
          if(!isMegaEvolved && opponentHealth <= 100){
            megaEvolve();
            return
          }
            setTimeout(function(){
              opponentMove();
          },3000)
      };
      electroBall = function(){
        $("#opponentMove").hide();
        $(".flame").hide();
        $("#myMove").show();
        opponentAttacking = false;
        $('#myMove').attr('src','sprites/ball.png');
        $('#myMove').attr('width','150')
        $("#myMove").css("animation-name","ram");
        $("#myMove").css("animation-duration","3s");
        //$("#menu").hide();
        type('you used electro ball.')
        meAttacking = true;
        decreaseOpponentHp(50);
        setTimeout(function(){
          $("#myMove").css("animation-name",null);
          $('#myMove').hide();
          $("#menu").hide();
          if(myHealth<=0){
            gameOver(true)
          }
          if(opponentHealth<=0){
            gameOver(false)
          }
          if(!isMegaEvolved && opponentHealth <= 100){
            megaEvolve();
            return
          }
            setTimeout(function(){
              opponentMove();
          },7000)
    },3000);
  };
    voltTackle = function(){
      opponentAttacking = false;
      $("#opponentMove").hide();
      $(".flame").hide();
      $('#pikachu').attr('src','sprites/volt.png');
      $('#pikachu').attr('width','150')
      $("#pikachu").css("animation-name","ram");
      $("#pikachu").css("animation-duration","3s");
      //$("#menu").hide();
      type('you used volt tackle. it also damages pikachu')
      meAttacking = true;
      decreaseOpponentHp(100);
      decreaseMyHp(10);
      setTimeout(function(){
        $('#pikachu').attr('src','sprites/pikachu.gif');
        $('#pikachu').attr('width','200')
        $("#pikachu").css("animation-name",null);
        $("#menu").hide();
        if(myHealth<=0){
          gameOver(true)
        }
        if(opponentHealth<=0){
          gameOver(false)
        }
        if(!isMegaEvolved && opponentHealth <= 100){
          megaEvolve();
          return
        }
        setTimeout(function(){
            opponentMove();
        },5000)
      },5000)
  };
  tackle = function(){
    opponentAttacking = false;
    $("#opponentMove").hide();
    $("#flame").hide();
    $('#pikachu').attr('src','sprites/tackle.png');
    $('#pikachu').attr('width','150')
    $("#pikachu").css("animation-name","ram");
    $("#pikachu").css("animation-duration","3s");
    $("#menu").hide();
    type('you used tackle')
    meAttacking = true;
    decreaseOpponentHp(10);
    setTimeout(function(){
      $('#pikachu').attr('src','sprites/pikachu.gif');
      $('#pikachu').attr('width','200')
      $("#pikachu").css("animation-name",null);
      $("#menu").hide();
      if(myHealth<=0){
        gameOver(true)
      }
      if(opponentHealth<=0){
        gameOver(false)
      }
      if(!isMegaEvolved && opponentHealth <= 100){
        megaEvolve();
        return
      }
      setTimeout(function(){
          opponentMove();
      },3000)
    },3000)
};
            var megaEvolve = function(){
              for(var i = 0;i < 50;i++){
              $("#mega").show()
              $("#mega").hide()
            }
              var r = Math.random();
              var ra = r*3;
              if(ra <= 1.5){
              $('#charizard').attr('src','sprites/mega%20charizard%20y.gif');
              $('#charizard').attr('width',300)
            }
            else{
            $('#charizard').attr('src','sprites/mega%20charizard%20x.gif')
            $('#charizard').attr('width',250)
            $(".flame").attr('src','sprites/hot%20flame.gif')
          }
            isMegaEvolved = true;
            opponentHealth = 400;
            decreaseOpponentHp((400 - opponentHealth) * -1);
              type('charizard mega evolved!his health restored')
            setTimeout(function(){
              opponentMove();
            },8000)
          };
          var myTurn = function(){
            $("#menu").show()
            $("button").on('click',function(){
              $("#menu").hide();
            })
          }
              var opponentMove = function(){
                var moves = ['wildfire', 'flamethrower', 'fire punch', 'seismic toss'];
                var ran = Math.floor(Math.random()*moves.length);
                if(ran === 0){
                  $(".flame").hide();
                  $("#opponentMove").show();
                  $('#opponentMove').attr('src', 'sprites/wildfire.gif');
                type('charizard used wildfire');
                decreaseMyHp(20);
                if(myHealth<=0){
                  gameOver(true)
                }
                if(opponentHealth<=0){
                  gameOver(false)
                }
                myTurn();
              }
                else if(ran === 1){
                  type('charizard used flamethrower');
                  $(".flame").show();
                  $("#opponentMove").hide();
                  decreaseMyHp(10);
                  if(myHealth<=0){
                    gameOver(true)
                  }
                  if(opponentHealth<=0){
                    gameOver(false)
                  }
                  myTurn();
                }
                else if(ran === 2){
                  type('charizard used blast burn');
                  $("#opponentMove").show();
                  $("#opponentMove").attr('src','sprites/blast%20burn.gif')
                  decreaseMyHp(100);
                  decreaseOpponentHp(10);
                  if(myHealth<=0){
                    gameOver(true)
                  }
                  if(opponentHealth<=0){
                    gameOver(false)
                  }
                  setTimeout(function(){
                    myTurn();
                  },4000)
                }
                else{
                  $("#opponentMove").hide();
                  type('charizard used seismic toss');
                  decreaseMyHp(100);
                  $("#pikachu").css('animation-name','jump')
                  $("#pikachu").css('animation-duration','3s')
                  setTimeout(function(){
                    $("#pikachu").css('animation-name',null)
                    myTurn();
                  },4000)
                  if(myHealth<=0){
                    gameOver(true)
                  }
                  if(opponentHealth<=0){
                    gameOver(false)
                  }
                }
          };
        </script>
      </body>
      </html>

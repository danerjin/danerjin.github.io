<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset = 'utf-8'>
  <title>charizard battle</title>
  <link rel = 'shortcut icon' type = 'image/gif' href = 'sprites/mega%20charizard%20x.gif'>
  <style>
  @keyframes ram{
    from{
      left:20%;
      bottom:0px;
    }
    to{
      left:70%;
      bottom:40%;
    }
  }
  @keyframes jump{
    0%{bottom:10%}
    50%{bottom:75%}
    100%{bottom:10%}
  }
  .game{
    background-image: url('sprites/background.png');
    background-size: 100% 100%;
    background-repeat: no-repeat;
    position:absolute;
    top:0px;
    left:0px;
    right:0px;
    bottom:70px;
    display: none;
  }
  #moves{
    z-index: 6;
  }
  #myHealthBar{
    position:absolute;
    left:20%;
    bottom: 20%;
    z-index:5;
    color:white;
    font-smooth: never;
    -webkit-font-smoothing : none;
  }
  #opponentHealthBar{
    position:absolute;
    right:23%;
    top:15%;
    z-index:5;
    color:white;
    font-smooth: never;
    -webkit-font-smoothing : none;
  }
  .container{
    width:50px;
    background-color: black;
    color: black;
    border-radius: 5px;
    height:10px;
  }
  .bar{
    width:50px;
    color: lightgreen;
    background-color: lightgreen;
    border-radius: 5px;
    height:10px;
  }
  .pokeball{
    background-image: url('sprites/pokeball.png');
    background-size: 100% 100%;
    width:11px;
    height:11px;
    position: relative;
    float: left;
  }
  .pokeball2{
    background-image: url('sprites/pokeball.png');
    background-size: 100% 100%;
    width:11px;
    height:11px;
    position: relative;
    float: right;
  }
  #return{
    position: absolute;
    top: 425px;
    left:500px;
  }
  #opponentMove{
    position:absolute;
    left:15%;
    bottom:0px;
    z-index: 1;
  }
  #myMove{
    position:absolute;
    right:15%;
    bottom:50%;
    z-index: 3;
  }
  #opponentPokemon{
    position: absolute;
    right:15%;
    top:25%;
    z-index: 2;
    display:none;
  }
  #mega{
    position: absolute;
    right:20%;
    top:100px;
    z-index: 2;
  }
  #myPokemon{
    position: absolute;
    left:15%;
    bottom: 0px;
    z-index: 2;
    display:none;
  }
  .flame{
    transform: rotate(250deg);
    position:absolute;
    left:25%;
    bottom: -100px;
    display:none;
  }
  #typewriter{
    color: white;
    font-family: monospace;
    background-color: red;
    border: 10px solid grey;
    width:100%;
    height:50px;
    position:absolute;
    left:0px;
    bottom: 0px;
  }
  button {
    padding:10px;
    display: inline-block;
    cursor: pointer;
    text-align: center;
    text-decoration: none;
    outline: none;
    color: #fff;
    background-color: #4CAF50;
    border: none;
    border-radius: 15px;
    box-shadow: 0 5px #999;
    transition-duration: 0.4s;
    margin: 10px;
  }

  button:hover {
    background-color: #f44336;
  }

  button:active {
    background-color: #3e8e41;
    box-shadow: 0 2px #666;
    transform: translateY(4px);
  }
  #theme{
    display: none;
  }
  #mega{
    position: absolute;
    top:10%;
    right:20%;
    display: none;
  }
  #menu{
    width:200px;
    height:200px;
    position: absolute;
    top:400px;
    left:30%;
    display:none;
  }
  .mega{
    background-image: url('sprites/mega%20stone.png');
    background-size: 100% 100%;
    width:10px;
    height:10px;
    display:none;
  }
  .mega1{
    float: left;
  }
  .mega2{
    float: right;
  }
  #start_button{
    position: absolute;
    left:40%;
    top:50%;
  }
  </style>
</head>
<body>
  <div class = 'game'>
  <div id ='myHealthBar'><div class = 'pokeball2'></div><div class = 'pokeball2'></div><div class = 'pokeball2'></div><div class = 'pokeball2'></div><div class = 'pokeball2'></div><div><div id = 'myName'>pikachu</div><div id = 'myHealthText'>300/300</div><div class = 'container'><div id = 'myHealthGraphic' class = 'bar'>  </div></div><span class = 'mega2 mega'></span></div></div>
  <div id ='opponentHealthBar'><div><div class = 'pokeball'></div><div class = 'pokeball'></div><div class = 'pokeball'></div><div class = 'pokeball'></div><div class = 'pokeball'></div></div><div><div id = 'opponentName'>charizard</div><div id = 'opponentHealthText'>400/400</div><div class = 'container'><div id = 'opponentHealthGraphic' class = 'bar'>  </div></div><span class = 'mega1 mega'></span></div></div>
  <img id = 'opponentPokemon' src = 'sprites/Charizard.gif' width = '200' alt = "opponent's pokemon">
  <img id = 'mega' src = 'sprites/megaEffect2.gif' width = '25'>
  <img id = 'myPokemon' src = 'sprites/pikachu_1.gif' width = '125' alt = 'my pokemon'>
  <img id = 'opponentMove' src = '' width = '200'>
  <img class = 'flame' src = 'sprites/flamethrower.gif'>
  <img id = 'myMove' src = '' width = '200'>
  <div id = 'menu'>
  <div id = 'moves'>
    <button id = 'electro-ball' onclick = 'electroBall()'>electro ball</button>
    <button id = 'volt-tackle' onclick="voltTackle()">volt tackle</button>
    <button id = 'thunder-bolt' onclick="thunderbolt()">thunderbolt</button>
    <button id = 'Gigavolt-havoc' onclick="tackle()">tackle</button>
  </div>
</div>
  <!--<a id = 'return' href='forest11.htm'>go back to main route</a>-->
  </div>
  <button onclick = 'startTheGame()' id = 'start_button'>start</button>
  <div id = 'typewriter'></div>
  <script src = 'jquery.js'></script>
  <script>
  var wantsTheme = confirm('do you want background music?')
  if(wantsTheme){
    var theme = new sound('theme.mp3')
  }
  var opponentHealth = 400;
  var myHealth = 300;
  var megaEvolve;
  var isTyping = false;
  var meAttacking = false;
  var opponentAttacking = false;
  var gameIsOver = false;
  var effect = 'sprites/megaEffect.gif'
  function sound(src) {
  this.sound = document.createElement("audio");
  this.sound.src = src;
  this.sound.setAttribute("preload", "auto");
  this.sound.setAttribute("controls", "none");
  this.sound.style.display = "none";
  document.body.appendChild(this.sound);
  this.play = function(){
      this.sound.play();
  }
  this.stop = function(){
      this.sound.pause();
  }
}
  var type = function(typo){
    isTyping = true;
    opponentAttacking = false;
    meAttacking = false;
    $("#typewriter").text('')
    for(let i = 0;i < typo.length;i++){
      setTimeout(function(){
        $("#typewriter").append(typo[i])
      },100 * i)
    }
  }
  startTheGame = function(){
    if(wantsTheme){
      theme.play();
    }
    $("#start_button").hide();
    setTimeout(function(){
      charizard.sounds.normal.play()
      $('#opponentPokemon').fadeIn(1000);
      type('go, charizard!')
      setTimeout(function(){
        type('What will pikachu do?')
        setTimeout(function(){
          $("#menu").show();
        },2000);
      },2000)
    },1500);
    pikachu.sound.play()
    $(".game").show();
    $('#myPokemon').fadeIn(1000);
    type('go, pikachu!')
  };
  var decreaseMyHp = function(Hp){
    for(let i = 0;i < Hp;i ++){
      var id = setTimeout(function(){
        if(myHealth<=0){
            $("#myPokemon").fadeOut(5000);
            $("#menu").hide();
            $("#myHealthBar").hide();
            $("#opponentHealthBar").hide();
            if(!gameIsOver){
              setTimeout(function(){
                type('you lost')
              },2750);
            }
          gameIsOver = true;
          $("#return").show();
          clearTimeout(id)
          $("#menu").hide()
          return
        }
        myHealth--;
        $('#myHealthText').text(myHealth + '/300');
        $("#myHealthGraphic").css("width",myHealth/6 + "px");
        if(myHealth <= 75){
          $("#myHealthGraphic").css('background-color','red')
          $("#myHealthGraphic").css('color','red')
        }
        else if(myHealth <= 150){
          $("#myHealthGraphic").css('background-color','yellow')
          $("#myHealthGraphic").css('color','yellow')
        }
    },50 * i)
  }
}
  var decreaseOpponentHp = function(Hp){
    for(let j = 0;j < Hp;j++){
        var id = setTimeout(function(){
        if(opponentHealth<=0){
          $("#opponentPokemon").fadeOut(5000);
          $("#menu").hide();
          $("#myHealthBar").hide();
          $("#opponentHealthBar").hide();
            if(!gameIsOver){
              setTimeout(function(){
                type('you won!!!!!!!!!!!!!!')
              },2000);
            }
          gameIsOver = true;
          $("#return").show();
          clearTimeout(id)
          $("#menu").hide()
          return
        }
        opponentHealth--;
        $('#opponentHealthText').text(opponentHealth + '/400');
        $("#opponentHealthGraphic").css("width",opponentHealth/8 + "px");
        if(opponentHealth <= 100){
          $("#opponenHealthGraphic").css('background-color','red')
          $("#opponenHealthGraphic").css('color','red')
        }
        else if(opponentHealth <= 200){
          $("#opponentHealthGraphic").css('background-color','yellow')
          $("#opponenHealthGraphic").css('color','yellow')
        }
      },50 * j)
      }
    }
    var increaseOpponentHp = function(Hp){
      for(let j = 0;j < Hp;j++){
          setTimeout(function(){
          opponentHealth++;
          $('#opponentHealthText').text(opponentHealth + '/400');
          $("#opponentHealthGraphic").css("width",opponentHealth/8 + "px");
          if(opponentHealth > 400){
            opponentHealth = 400;
          }
          else if(opponentHealth <= 100){
            $("#opponenHealthGraphic").css('background-color','red')
            $("#opponenHealthGraphic").css('color','red')
          }
          else if(opponentHealth <= 200){
            $("#opponentHealthGraphic").css('background-color','yellow')
            $("#opponenHealthGraphic").css('color','yellow')
          }
          else if(opponentHealth > 200){
            $("#opponentHealthGraphic").css('background-color','lightgreen')
            $("#opponenHealthGraphic").css('color','lightgreen')
          }
        },10 * j)
        }
      }
    thunderbolt = function(){
      opponentAttacking = false;
      pikachu.myTurn(0)
    };
    electroBall = function(){
      opponentAttacking = false;
      pikachu.myTurn(1)
};
  voltTackle = function(){
    opponentAttacking = false;
    pikachu.myTurn(2)
};
tackle = function(){
  opponentAttacking = false;
  pikachu.myTurn(3)
};
var pikachu = {
name:pikachu,
maxHealth:300,
health:300,
canMegaEvolve:false,
image:'sprites/pikachu_1.gif',
width:'150',
sound:new sound('sprites/pikachu.ogg')
}
var charizard = {
name:charizard,
maxHealth:400,
health:400,
canMegaEvove:true,
forms:2,
width:'200',
images:{
  normal:'sprites/Charizard.gif',
  x:'sprites/mega%20charizard%20x.gif',
  y:'sprites/mega%20charizard%20y.gif',
  attack1:'sprites/charizard2.gif',
  attack2:'sprites/Charizard3.gif',
  attack3:'sprites/Charizard4.gif'
},
isMegaEvolved:false,
sounds:{
  normal:new sound('sprites/charizard.ogg'),
  x:new sound('sprites/mega%20charizard%20x.ogg'),
  y:new sound('sprites/mega%20charizard%20y.ogg'),
}
}
          charizard.megaEvolve = function(){
            setTimeout(function(){
              $("#mega").fadeIn(100)
            },100);
            $(".mega1").show()
            $("#opponentPokemon").attr('src',effect)
            setTimeout(function(){
              var r = Math.random();
              var ra = r*3;
              if(ra <= 1.5){
                $('#opponentPokemon').attr('src',charizard.images.y);
                $('#opponentPokemon').attr('width',300);
                charizard.images.normal = charizard.images.y;
                charizard.form = 'y';
                charizard.sounds.normal = charizard.sounds.y;
              }
              else{
                $('#opponentPokemon').attr('src',charizard.images.x);
                $('#opponentPokemon').attr('width',250);
                $(".flame").attr('src','sprites/hot%20flame.gif');
                charizard.images.normal = charizard.images.x;
                charizard.form = 'x';
                charizard.sounds.normal = charizard.sounds.x;
              }
              charizard.sounds.normal.play();
            },1500);
            charizard.isMegaEvolved = true;
            increaseOpponentHp(400 - opponentHealth);
              type('charizard mega evolved!his health restored')
              setTimeout(function(){
                $("#menu").hide()
                $("#mega").hide()
                charizard.opponentMove();
              },4100);
          };
        pikachu.myTurn = function(num){
          $("#menu").hide()
          if(num === 0){
            $("#opponentMove").hide();
            $(".flame").hide();
            $("#myMove").css("animation-name","none");
            $('#myMove').show();
            $('#myMove').attr('src','sprites/lightning.png');
            //$("#menu").hide();
            type('you used thunderbolt')
            meAttacking = true;
            decreaseOpponentHp(10);
              if(!charizard.isMegaEvolved && opponentHealth <= 100){
                charizard.megaEvolve();
                return
              }
              setTimeout(function(){
                if(!gameIsOver){
                  charizard.opponentMove()
                }
              },3000);
          }
          else if(num === 1){
            $("#opponentMove").hide();
            $(".flame").hide();
            $("#myMove").show();
            $('#myMove').attr('src','sprites/ball.png');
            $('#myMove').attr('width','150')
            $("#myMove").css("animation-name","ram");
            $("#myMove").css("animation-duration","3s");
            //$("#menu").hide();
            type('you used electro ball.')
            meAttacking = true;
            decreaseOpponentHp(50);
            setTimeout(function(){
              $("#myMove").css("animation-name","none");
              $('#myMove').hide();
              if(!charizard.isMegaEvolved && opponentHealth <= 100){
                charizard.megaEvolve();
                return
              }
              if(!gameIsOver){
                charizard.opponentMove();
              }
          },3000);
          }
          else if(num === 2){
            $("#myPokemon").css("animation-name","none");
            $("#opponentMove").hide();
            $(".flame").hide();
            $('#myPokemon').attr('src','sprites/volt.png');
            $('#myPokemon').attr('width','150')
            $("#myPokemon").css("animation-name","ram");
            $("#myPokemon").css("animation-duration","3s");
            type('you used volt tackle. it also damages pikachu')
            meAttacking = true;
            decreaseOpponentHp(100);
            decreaseMyHp(10);
            setTimeout(function(){
              $('#myPokemon').attr('src',pikachu.image);
              $('#myPokemon').attr('width',pikachu.width)
              $("#myPokemon").css("animation-name","none");
              if(!charizard.isMegaEvolved && opponentHealth <= 100){
                charizard.megaEvolve();
                return
              }
              if(!gameIsOver){
                charizard.opponentMove()
              }
            },5000);
          }
          else if(num === 3){
            $(".flame").hide()
            $("#opponentMove").hide()
            $("#myPokemon").css("animation-name","none");
            $("#opponentMove").hide();
            $("#flame").hide();
            $('#myPokemon').attr('src','sprites/tackle.png');
            $('#myPokemon').attr('width','150')
            $("#myPokemon").css("animation-name","ram");
            $("#myPokemon").css("animation-duration","3s");
            type('you used tackle')
            meAttacking = true;
            decreaseOpponentHp(10);
            setTimeout(function(){
              $('#myPokemon').attr('src',pikachu.image);
              $('#myPokemon').attr('width',pikachu.width)
              $("#myPokemon").css("animation-name","none");
              if(!charizard.isMegaEvolved && opponentHealth <= 100){
                charizard.megaEvolve();
                return
              }
                if(!gameIsOver){
                  charizard.opponentMove()
                }
            },3000)
          }
        }
            charizard.opponentMove = function(){
              $("#myMove").hide()
              var moves = ['wildfire', 'flamethrower', 'fire punch', 'seismic toss'];
              var ran = Math.floor(Math.random()*moves.length);
              if(ran === 0){
                $(".flame").hide();
                $("#opponentMove").show()
                $('#opponentMove').attr('src', 'sprites/wildfire.gif');
              type('charizard used wildfire');
              decreaseMyHp(20);
            }
              else if(ran === 1){
                if(!charizard.isMegaEvolved){
                  $("#opponentPokemon").attr('src',charizard.images.attack1)
                  setTimeout(function(){
                      $("#opponentPokemon").attr('src',charizard.images.normal)
                  },1000)
                }
                type('charizard used flamethrower');
                $(".flame").show();
                decreaseMyHp(10);
              }
              else if(ran === 2){
                $(".flame").hide()
                if(!charizard.isMegaEvolved){
                  $("#opponentPokemon").attr('src',charizard.images.attack3)
                  setTimeout(function(){
                    $("#opponentPokemon").attr('src',charizard.images.normal)
                  },1000)
                  type('charizard used dragon tail')
                  decreaseMyHp(50)
                  setTimeout(function(){
                    $("#menu").show()
                  },3000)
                  return;
                }
                type('charizard used blast burn');
                $("#opponentMove").show();
                $("#opponentMove").attr('src','sprites/blast%20burn.gif')
                decreaseMyHp(100);
                decreaseOpponentHp(10);
                if(myHealth<=0){
                  $("#myPokemon").fadeOut(5000);
$("#menu").hide();
$("#myHealthBar").hide();
$("#opponentHealthBar").hide();
$("svg").hide();
type('you lost')
$("#return").show();


                }
                if(opponentHealth<=0){
                  $("#opponentPokemon").fadeOut(5000);
$("#menu").hide();
$("#myHealthBar").hide();
$("#opponentHealthBar").hide();
$("svg").hide();
type('you won!!!!!!')
$("#return").show();
                }
              }
              else{
                $("#myPokemon").css("animation-name","none");
                $("#opponentMove").hide();
                type('charizard used seismic toss');
                decreaseMyHp(100);
                $("#myPokemon").css('animation-name','jump')
                $("#myPokemon").css('animation-duration','3s')
              }
              setTimeout(function(){
                $("#myPokemon").css('animation-name',null)
              },5000)
              if(!gameIsOver){
                setTimeout(function(){
                  $("#menu").show()
                },4000)
              }
            }
      </script>
    </body>
    </html>
